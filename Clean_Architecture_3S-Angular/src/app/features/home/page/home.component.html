<div id="content">
  <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
    <div>
      <label for="firstName">First Name</label>
      <input id="firstName" formControlName="firstName">
      <div *ngIf="firstName.invalid && (firstName.dirty || firstName.touched)">
        <small *ngIf="firstName.hasError('required')">First Name is required.</small>
        <small *ngIf="firstName.hasError('maxlength')">Max length is 20 characters.</small>
        <small *ngIf="firstName.hasError('pattern')">Only Arabic or English letters and spaces are allowed.</small>
      </div>
    </div>
    
    <div>
      <label for="middleName">Middle Name</label>
      <input id="middleName" formControlName="middleName">
      <div *ngIf="middleName.invalid && (middleName.dirty || middleName.touched)">
        <small *ngIf="middleName.hasError('maxlength')">Max length is 40 characters.</small>
        <small *ngIf="middleName.hasError('pattern')">Only Arabic or English letters and spaces are allowed.</small>
      </div>
    </div>
  
    <div>
      <label for="lastName">Last Name</label>
      <input id="lastName" formControlName="lastName">
      <div *ngIf="lastName.invalid && (lastName.dirty || lastName.touched)">
        <small *ngIf="lastName.hasError('required')">Last Name is required.</small>
        <small *ngIf="lastName.hasError('maxlength')">Max length is 20 characters.</small>
        <small *ngIf="lastName.hasError('pattern')">Only Arabic or English letters and spaces are allowed.</small>
      </div>
    </div>
    
    <div>
      <label for="birthDate">Birth Date</label>
      <input type="date" id="birthDate" formControlName="birthDate">
      <div *ngIf="birthDate.invalid && (birthDate.dirty || birthDate.touched)">
        <small *ngIf="birthDate.hasError('required')">Birth Date is required.</small>
        <small *ngIf="birthDate.hasError('minAge')">Minimum age is 20 years.</small>
      </div>
    </div>
  
    <div>
      <label for="mobileNumber">Mobile Number</label>
      <input id="mobileNumber" formControlName="mobileNumber">
      <div *ngIf="mobileNumber.invalid && (mobileNumber.dirty || mobileNumber.touched)">
        <small *ngIf="mobileNumber.hasError('required')">Mobile Number is required.</small>
        <small *ngIf="mobileNumber.hasError('pattern')">Format example +021006158123.</small>
      </div>
    </div>
    
    <div>
      <label for="email">Email</label>
      <input id="email" formControlName="email">
      <div *ngIf="email.invalid && (email.dirty || email.touched)">
        <small *ngIf="email.hasError('required')">Email is required.</small>
        <small *ngIf="email.hasError('email')">Invalid email.</small>
      </div>
    </div>
  



    <div class="col 3">
      <form [formGroup]="currentAdd">
        <h4>Address {{ 1}}</h4>
        <div>
          <label for="governate">Governate</label>
          <select id="governate" formControlName="governate" (change)="getetallcitiesbygovernorateid($event)">
            <option selected value=null>--Selcet Governate</option>
            <option *ngFor="let gov of governates" [value]="gov.id">{{gov.name}}</option>
          </select>
          <div *ngIf="currentAdd?.get('governate').invalid && (currentAdd?.get('governate').dirty || currentAdd?.get('governate').touched)">
            <small *ngIf="currentAdd?.get('governate').hasError('required')">Governate is required.</small>
          </div>
        </div>
        
        <div>
          <label for="city">City</label>
          <select id="city" formControlName="cityId">
            <option  selected value=null>--Selcet City</option>
            <option *ngFor="let city of currentcities" [value]="city.id">{{city.name}}</option>
          </select>
          <div *ngIf="currentAdd?.get('cityId').invalid && (currentAdd?.get('cityId').dirty || currentAdd?.get('cityId').touched)">
            <small *ngIf="currentAdd?.get('cityId').hasError('required')">cityId is required.</small>
          </div>
        </div>
  
        <div>
          <label for="street">Street</label>
          <input id="street" formControlName="street">
          <div *ngIf="currentAdd?.get('street').invalid && (currentAdd?.get('street').dirty || currentAdd?.get('street').touched)">
            <small *ngIf="currentAdd?.get('street').hasError('required')">Street is required.</small>
            <small *ngIf="currentAdd?.get('street').hasError('maxlength')">Max length is 200 characters.</small>
          </div>
        </div>
        
        <div>
          <label for="buildingNumber">Building Number</label>
          <input id="buildingNumber" formControlName="buildingNumber">
          <div *ngIf="currentAdd?.get('buildingNumber').invalid && (currentAdd?.get('buildingNumber').dirty || currentAdd?.get('buildingNumber').touched)">
            <small *ngIf="currentAdd?.get('buildingNumber').hasError('required')">Building Number is required.</small>
          </div>
        </div>

        <div>
          <label for="flatNumber">Flat Number</label>
          <input id="flatNumber" formControlName="flatNumber">
          <div *ngIf="currentAdd?.get('flatNumber').invalid && (currentAdd?.get('flatNumber').dirty || currentAdd?.get('flatNumber').touched)">
            <small *ngIf="currentAdd?.get('flatNumber').hasError('required')">Building Number is required.</small>
          </div>
        </div>


      </form>
      </div> 
  
    <table>
      <thead>
        <tr>
          <th>governate</th>
          <th>City</th>
          <th>Street</th>
          <th>buildingNumber</th>
          <th>flatNumber</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody formArrayName="addresses">
        <tr *ngFor="let address of addresses.controls; let i=index" [formGroupName]="i">
          <td>
            <label>{{getGovernorateName(address?.get('governate')?.value)}}</label>
          </td>
          <td>
            <label>{{getCityName(address?.get('cityId')?.value)}}</label>
            
          </td>
          <td>
            <label>{{address?.get('street')?.value}}</label>
            
          </td>
          <td>
            <label>{{address?.get('buildingNumber')?.value}}</label>
          </td>
          <td>
            <label>{{address?.get('flatNumber')?.value}}</label>
          </td>
          <td>
            <button type="button" (click)="removeAddress(i)">Remove</button>
          </td>
        </tr>
      </tbody>
    </table>
  
    <button type="button" (click)="addAddress()">Add Address</button>

    <button type="submit">Submit</button>
  </form>
  
</div>
